-- 示例数据插入脚本
-- 用于测试数据仓库功能

-- 插入示例用户数据到ODS层
USE ods_enterprise;

INSERT INTO ods_user_info PARTITION(dt='2024-12-26') VALUES
('U001', 'zhang_san', 'zhangsan@email.com', '13800138001', '2024-01-15 10:30:00', '2024-12-25 15:20:00', 'active', '2024-01-15 10:30:00', '2024-12-25 15:20:00'),
('U002', 'li_si', 'lisi@email.com', '13800138002', '2024-02-20 14:15:00', '2024-12-24 09:45:00', 'active', '2024-02-20 14:15:00', '2024-12-24 09:45:00'),
('U003', 'wang_wu', 'wangwu@email.com', '13800138003', '2024-03-10 16:45:00', '2024-12-23 11:30:00', 'vip', '2024-03-10 16:45:00', '2024-12-23 11:30:00'),
('U004', 'zhao_liu', 'zhaoliu@email.com', '13800138004', '2024-04-05 09:20:00', '2024-12-22 14:10:00', 'premium', '2024-04-05 09:20:00', '2024-12-22 14:10:00'),
('U005', 'qian_qi', 'qianqi@email.com', '13800138005', '2024-05-12 11:00:00', '2024-12-21 16:55:00', 'active', '2024-05-12 11:00:00', '2024-12-21 16:55:00');

-- 插入示例订单数据到ODS层
INSERT INTO ods_order_info PARTITION(dt='2024-12-26') VALUES
('O001', 'U001', 'P001', 'iPhone 15 Pro', 1, 8999.00, 8999.00, 'completed', 'credit_card', '2024-12-25 10:30:00', '2024-12-25 10:35:00', '2024-12-25 10:30:00'),
('O002', 'U001', 'P002', 'MacBook Pro', 1, 15999.00, 15999.00, 'completed', 'alipay', '2024-12-25 14:20:00', '2024-12-25 14:25:00', '2024-12-25 14:20:00'),
('O003', 'U002', 'P003', '运动鞋', 2, 299.00, 598.00, 'completed', 'wechat_pay', '2024-12-25 16:45:00', '2024-12-25 16:50:00', '2024-12-25 16:45:00'),
('O004', 'U003', 'P004', '笔记本电脑', 1, 5999.00, 5999.00, 'pending', 'credit_card', '2024-12-25 18:30:00', NULL, '2024-12-25 18:30:00'),
('O005', 'U002', 'P005', '连衣裙', 3, 199.00, 597.00, 'completed', 'alipay', '2024-12-25 20:15:00', '2024-12-25 20:20:00', '2024-12-25 20:15:00'),
('O006', 'U004', 'P001', 'iPhone 15 Pro', 2, 8999.00, 17998.00, 'completed', 'bank_transfer', '2024-12-25 21:00:00', '2024-12-25 21:05:00', '2024-12-25 21:00:00'),
('O007', 'U005', 'P006', '智能手表', 1, 2999.00, 2999.00, 'shipped', 'credit_card', '2024-12-25 22:30:00', '2024-12-25 22:35:00', '2024-12-25 22:30:00'),
('O008', 'U003', 'P007', '无线耳机', 2, 899.00, 1798.00, 'completed', 'wechat_pay', '2024-12-25 23:15:00', '2024-12-25 23:20:00', '2024-12-25 23:15:00');

-- 验证数据插入
SELECT 'ODS用户表记录数:', COUNT(*) FROM ods_user_info WHERE dt='2024-12-26';
SELECT 'ODS订单表记录数:', COUNT(*) FROM ods_order_info WHERE dt='2024-12-26';

-- 显示示例数据
SELECT '=== 用户数据示例 ===' as info;
SELECT user_id, username, email, status FROM ods_user_info WHERE dt='2024-12-26' LIMIT 3;

SELECT '=== 订单数据示例 ===' as info;
SELECT order_id, user_id, product_name, total_amount, order_status FROM ods_order_info WHERE dt='2024-12-26' LIMIT 5;